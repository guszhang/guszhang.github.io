<!--
Author: Dr. Cheng Zhang <cheng.zhang@manchester.ac.uk>
Date: 30/10/2024
Version: 2
The University of Manchester
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PCB Stylophone Marking Sheet</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        table {
            border-width: 2px;
            border-style: solid;
            border-collapse: collapse;
            border-color: black;
            text-align: left;
            margin: 0 auto;
        }

        td,
        th {
            border-width: 1px;
            border-style: solid;
            border-color: black;
            padding: 0 5px;
        }

        .header,
        .footer {
            text-align: center;
            background-color: #f1f1f1;
        }

        h1 {
            margin: 0 0;
            font-size: 1.5em;
        }

        h2 {
            margin: 0 0;
            font-size: 1.2em;
        }

        #mark,
        #section1mark {
            color: red;
        }

        .section1,
        .section2,
        .section3,
        .section4,
        .appendix1,
        .appendix2 {
            margin: 20px 0;
        }

        @media print {

            .appendix1,
            .appendix2 {
                display: none;
            }
        }

        p {
            margin: 2px 0;
            font-size: 0.8em;
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>EEEN11201 EEE in Practice</h1>
        <h2>Circuit Assembly Marking Sheet</h2>
        <table>
            <tr>
                <th>Date</th>
                <td id="date"></td>
                <th>Student ID</th>
                <td><input id="student-id" type="text" /></td>
            </tr>
            <tr>
                <th>Time</th>
                <td id="time"></td>
                <th>Board</th>
                <td>PCB Stylophone v3</td>
            </tr>
            <tr>
                <th>Marker</th>
                <td>Self-marking</td>
                <th>Mark</th>
                <td id="mark">100</td>
            </tr>
        </table>
        <table style="border-width: 0; margin: 5px auto;">
            <tr>
                <td style="border-width: 0">
                    <button onclick="resetForm()">Reset Form</button>
                </td>
                <td style="border-width: 0">
                    <button onclick="calculateMarks()">Calculate Marks</button>
                </td>
                <td style="border-width: 0">
                    <button onclick="saveMarks()">Save (Print as PDF)</button>
                </td>
            </tr>
        </table>
    </div>
    <div class="section1">
        <h2>Section I: Picking and placing components (50 marks)</h2>
        <p>Any wrong value or polarity of a component will result in a loss of 10 marks. Minimum mark for this section
            is 0. Markers visually check the values and polarities.</p>
        <table>
            <tr>
                <th>Component</th>
                <th>Value</th>
                <th>Polarity</th>
                <th>Component</th>
                <th>Value</th>
                <th>Polarity</th>
            </tr>
            <tr>
                <td>C1</td>
                <td><input type="checkbox" id="val1" />100n</td>
                <td>-</td>
                <td>R10</td>
                <td><input type="checkbox" id="val2" />2.43k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>C2</td>
                <td><input type="checkbox" id="val3" />10n</td>
                <td>-</td>
                <td>R11</td>
                <td><input type="checkbox" id="val4" />2.61k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>J1</td>
                <td><input type="checkbox" id="val5" />battery</td>
                <td><input type="checkbox" id="val6" />correct</td>
                <td>R12</td>
                <td><input type="checkbox" id="val7" />2.74k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>LS1</td>
                <td><input type="checkbox" id="val8" />buzzer</td>
                <td>-</td>
                <td>R13</td>
                <td><input type="checkbox" id="val9" />2.87k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>R1</td>
                <td><input type="checkbox" id="val10" />10k</td>
                <td>-</td>
                <td>R14</td>
                <td><input type="checkbox" id="val11" />3.01k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>R2</td>
                <td><input type="checkbox" id="val12" />22.1k</td>
                <td>-</td>
                <td>R15</td>
                <td><input type="checkbox" id="val13" />3.24k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>R3</td>
                <td><input type="checkbox" id="val14" />1.62k</td>
                <td>-</td>
                <td>R16</td>
                <td><input type="checkbox" id="val15" />3.48k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>R4</td>
                <td><input type="checkbox" id="val16" />1.74k</td>
                <td>-</td>
                <td>R17</td>
                <td><input type="checkbox" id="val17" />3.65k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>R5</td>
                <td><input type="checkbox" id="val18" />1.82k</td>
                <td>-</td>
                <td>R18</td>
                <td><input type="checkbox" id="val19" />3.83k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>R6</td>
                <td><input type="checkbox" id="val20" />1.91k</td>
                <td>-</td>
                <td>R19</td>
                <td><input type="checkbox" id="val21" />4.12k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>R7</td>
                <td><input type="checkbox" id="val22" />2.05k</td>
                <td>-</td>
                <td>R20</td>
                <td><input type="checkbox" id="val23" />4.32k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>R8</td>
                <td><input type="checkbox" id="val24" />2.15k</td>
                <td>-</td>
                <td>R21</td>
                <td><input type="checkbox" id="val25" />4.64k</td>
                <td>-</td>
            </tr>
            <tr>
                <td>R9</td>
                <td><input type="checkbox" id="val26" />2.32k</td>
                <td>-</td>
                <td>U1</td>
                <td><input type="checkbox" id="val27" />NE555P</td>
                <td><input type="checkbox" id="val28" />correct</td>
            </tr>
            <tr>
                <td colspan="4"></td>
                <th>Total</th>
                <td id="section1mark"></td>
            </tr>
        </table>
    </div>
    <div class="section2">
        <h2>Section II: Soldering and Finishing (20 marks)</h2>
        <p>Please see Appendix I for more information.</p>
        <table>
            <tr>
                <th>Practice</th>
                <th>Descriptor</th>
            </tr>
            <tr>
                <td>Soldering</td>
                <td><select id="section2-1">
                        <option value="10">10 marks - More than 90% of soldering joints are soldered OK.</option>
                        <option value="5">5 marks - Between 50% and 90% soldering joints are soldered OK.</option>
                        <option id="section2-1def" value="0">0 marks - Less than 50% of soldering joints are soldered
                            OK.</option>
                    </select></td>
            </tr>
            <tr>
                <td>Finishing</td>
                <td><select id="section2-2">
                        <option value="10">10 marks - More than 90% of soldering joints are finished OK.</option>
                        <option value="5">5 marks - Between 50% and 90% soldering joints are finished OK.</option>
                        <option id="section2-2def" value="0">0 marks - Less than 50% of soldering joints are finished
                            OK.</option>
                    </select></td>
            </tr>
        </table>
    </div>
    <div class="section3">
        <h2>Section III: Functionality (30 marks)</h2>
        <p>Please see Appendix III for how to check the correct pitch.</p>
        <table>
            <tr>
                <th>Test</th>
                <th>Descriptor</th>
            </tr>
            <tr>
                <td>Current consumption</td>
                <td>
                    <select id="section3-1">
                        <option value="10">10 marks - Quiescent current is below 2 mA </option>
                        <option value="5">5 marks - Quiescent current is between 2 mA and 10 mA</option>
                        <option id="section3-1def" value="0">0 marks - Quiescent current is above 10 mA</option>
                        <option value="short">Short circuit: 0 marks for entire Section III</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>All keys make sounds</td>
                <td>
                    <select id="section3-2">
                        <option value="10">10 marks - All keys make sounds</option>
                        <option value="5">5 marks - At least 6 keys make sounds</option>
                        <option id="section3-2def" value="0">0 marks - Less than 6 keys make sound</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Correct pitch</td>
                <td>
                    <select id="section3-3">
                        <option value="10">10 marks - All keys have correct pitch</option>
                        <option value="5">5 marks - At least 6 keys have correct pitch</option>
                        <option id="section3-3def" value="0">0 marks - Less than 6 keys have correct pitch</option>
                    </select>
                </td>
            </tr>
        </table>
    </div>
    <div class="section4">
        <h2>Section IV: Penalty</h2>
        <p>You can request, up to three times, for replacements of PCBs, but each replacement request will result in
            deduction of 10 marks from the total awarded marks.</p>
        <table>
            <tr>
                <th>Number of replacement PCBs</th>
                <td><select id="section4">
                        <option id="section4def" value="0">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                    </select></td>
            </tr>
        </table>
    </div>
    <div class="footer">
        <h2>This is the end of the marking script.</h2>
        <p>EEEN10141 Electronics Project: Circuit Assembly Marking Sheet v2, CZ, 30/10/24</p>
    </div>
    <div class="appendix1">
        <h2>Appendix I. Soldering and Finishing Examples</h2>
        <p>A solder joint is recognised "ok" if it is <b>not</b> of one of the following conditions: insufficient
            wetting (pad and/or pin), solder starved, too much solder, solder bridge.</p>
        <p>A solder joint finishing is recognised "ok" if it is <b>not</b> of one of the following conditions: lifted
            pad (it'll be "ok" if a lifted pad is repaired), disturbed joint, overheated joint, insufficient trimming,
            over trimming, bent leads, and stray solder splatters over the PCB.</p>
        <p style="text-align:center; text-decoration:underline">An Ideal Solder Joint</p>
        <img width="600px" style="display: block; margin: 0 auto;" src="./tools_Solder_Joint.gif"
            alt="An Ideal Solder Joint" />
        <p style="text-align:center; text-decoration:underline">Examples of Solder Joint Conditions</p>
        <img width="600px" style="display: block; margin: 0 auto;" src="./tools_Header_Joints.jpg"
            alt="Examples of Solder Joint Conditions" />
        <p>Figures are from Earl, B. (n.d.) <a
                href="https://learn.adafruit.com/adafruit-guide-excellent-soldering/common-problems">Adafruit Guide to
                excellent soldering. Adafruit Learning System. </a> Please visit the website for more information.</p>
    </div>
    <div class="appendix2">
        <h2>Appendix II. Standard Tone Frequencies</h2>
        <p>You may download any frequency measurement app on your phone to check the pitch frequency. Due to available
            resistance values in EIA E96 (1%), the actual frequencies of tones may be deviated from the
            nominal frequencies. Note that errors accumulate, and differences may be more than the values shown in the
            following table.</p>
        <!--
        Key	Note	Colour	Nominal f (Hz)
        Actual centre f (Hz)	Difference
        12	E7	W	2637.02	2662.36429	0.96%
        11½	D#7	B	2489.015	2512.18914	0.93%
        11	D7	W	2349.315	2368.68261	0.82%
        10½	C#7	B	2217.46	2235.13235	0.80%
        10 	C7	W	2093.005	2110.26827	0.82%
        9	B6	W	1975.535	1990.89603	0.78%
        8½ 	A#6	B	1864.655	1879.39756	0.79%
        8	A6	W	1760	1772.29359	0.70%
        7½	G#6	B	1661.22	1672.46342	0.68%
        7	G6	W	1567.98	1577.05076	0.58%
        6½	F#6	B	1479.98	1487.93714	0.54%
        6 	F6	W	1396.915	1404.79112	0.56%
        5	E6	W	1318.51	1327.0199	0.65%
        4½ 	D#6	B	1244.51	1252.38799	0.63%
        4	D6	W	1174.66	1181.04554	0.54%
        3½	C#6	B	1108.73	1114.45895	0.52%
        3 	C6	W	1046.5	1052.21047	0.55%
        2	B5	W	987.765	992.572185	0.49%
        1½ 	A#5	B	932.33	936.89225	0.49%
        1	A5	W	880	883.650608	0.41%
        -->
        <table>
            <tr>
                <th>Key</th>
                <th>Note</th>
                <th>Colour</th>
                <th>Nominal f (Hz)</th>
                <th>Actual centre f (Hz)</th>
                <th>Difference</th>
            </tr>
            <tr>
                <td>12</td>
                <td>E7</td>
                <td>W</td>
                <td>2637.02</td>
                <td>2662.36429</td>
                <td>0.96%</td>
            </tr>
            <tr>
                <td>11½</td>
                <td>D#7</td>
                <td>B</td>
                <td>2489.015</td>
                <td>2512.18914</td>
                <td>0.93%</td>
            </tr>
            <tr>
                <td>11</td>
                <td>D7</td>
                <td>W</td>
                <td>2349.315</td>
                <td>2368.68261</td>
                <td>0.82%</td>
            </tr>
            <tr>
                <td>10½</td>
                <td>C#7</td>
                <td>B</td>
                <td>2217.46</td>
                <td>2235.13235</td>
                <td>0.80%</td>
            </tr>
            <tr>
                <td>10</td>
                <td>C7</td>
                <td>W</td>
                <td>2093.005</td>
                <td>2110.26827</td>
                <td>0.82%</td>
            </tr>
            <tr>
                <td>9</td>
                <td>B6</td>
                <td>W</td>
                <td>1975.535</td>
                <td>1990.89603</td>
                <td>0.78%</td>
            </tr>
            <tr>
                <td>8½</td>
                <td>A#6</td>
                <td>B</td>
                <td>1864.655</td>
                <td>1879.39756</td>
                <td>0.79%</td>
            </tr>
            <tr>
                <td>8</td>
                <td>A6</td>
                <td>W</td>
                <td>1760</td>
                <td>1772.29359</td>
                <td>0.70%</td>
            </tr>
            <tr>
                <td>7½</td>
                <td>G#6</td>
                <td>B</td>
                <td>1661.22</td>
                <td>1672.46342</td>
                <td>0.68%</td>
            </tr>
            <tr>
                <td>7</td>
                <td>G6</td>
                <td>W</td>
                <td>1567.98</td>
                <td>1577.05076</td>
                <td>0.58%</td>
            </tr>
            <tr>
                <td>6½</td>
                <td>F#6</td>
                <td>B</td>
                <td>1479.98</td>
                <td>1487.93714</td>
                <td>0.54%</td>
            </tr>
            <tr>
                <td>6</td>
                <td>F6</td>
                <td>W</td>
                <td>1396.915</td>
                <td>1404.79112</td>
                <td>0.56%</td>
            </tr>
            <tr>
                <td>5</td>
                <td>E6</td>
                <td>W</td>
                <td>1318.51</td>
                <td>1327.0199</td>
                <td>0.65%</td>
            </tr>
            <tr>
                <td>4½</td>
                <td>D#6</td>
                <td>B</td>
                <td>1244.51</td>
                <td>1252.38799</td>
                <td>0.63%</td>
            </tr>
            <tr>
                <td>4</td>
                <td>D6</td>
                <td>W</td>
                <td>1174.66</td>
                <td>1181.04554</td>
                <td>0.54%</td>
            </tr>
            <tr>
                <td>3½</td>
                <td>C#6</td>
                <td>B</td>
                <td>1108.73</td>
                <td>1114.45895</td>
                <td>0.52%</td>
            </tr>
            <tr>
                <td>3</td>
                <td>C6</td>
                <td>W</td>
                <td>1046.5</td>
                <td>1052.21047</td>
                <td>0.55%</td>
            </tr>
            <tr>
                <td>2</td>
                <td>B5</td>
                <td>W</td>
                <td>987.765</td>
                <td>992.572185</td>
                <td>0.49%</td>
            </tr>
            <tr>
                <td>1½</td>
                <td>A#5</td>
                <td>B</td>
                <td>932.33</td>
                <td>936.89225</td>
                <td>0.49%</td>
            </tr>
            <tr>
                <td>1</td>
                <td>A5</td>
                <td>W</td>
                <td>880</td>
                <td>883.650608</td>
                <td>0.41%</td>
            </tr>
        </table>
    </div>

    <script>
        document.getElementById("date").innerHTML = new Date().toLocaleDateString();
        document.getElementById("time").innerHTML = new Date().toLocaleTimeString();

        function calculateMarks() {
            var section1mark = 0;
            for (i = 0; i < 28; i++) {
                if (document.getElementById("val" + (i + 1)).checked) {
                    section1mark += 1;
                }
            }
            section1mark = Math.max(0, 50 - ((28 - section1mark) * 10));
            document.getElementById("section1mark").innerHTML = section1mark.toFixed(0);
            var section2mark = 0;
            section2mark += parseInt(document.getElementById("section2-1").value);
            section2mark += parseInt(document.getElementById("section2-2").value);
            var section3mark = 0;
            if (document.getElementById("section3-1").value == "short") {
                section3mark = 0;
            } else {
                section3mark += parseInt(document.getElementById("section3-1").value);
                section3mark += parseInt(document.getElementById("section3-2").value);
                section3mark += parseInt(document.getElementById("section3-3").value);
            }
            var section4mark = parseInt(document.getElementById("section4").value) * -10;
            var totalMark = section1mark + section2mark + section3mark + section4mark;
            totalMark = Math.max(0, totalMark);
            document.getElementById("mark").innerHTML = totalMark.toFixed(0);
        }

        function resetForm() {
            document.getElementById("date").innerHTML = new Date().toLocaleDateString();
            document.getElementById("time").innerHTML = new Date().toLocaleTimeString();
            for (i = 0; i < 28; i++) {
                document.getElementById("val" + (i + 1)).checked = false;
            }
            document.getElementById("section2-1def").selected = true;
            document.getElementById("section2-2def").selected = true;
            document.getElementById("section3-1def").selected = true;
            document.getElementById("section3-2def").selected = true;
            document.getElementById("section3-3def").selected = true;
            document.getElementById("section4def").selected = true;
            calculateMarks();
        }

        function saveMarks() {
            if (document.getElementById("student-id").value == "") {
                alert("Please enter your student ID.");
                return;
            }
            document.getElementById("date").innerHTML = new Date().toLocaleDateString();
            document.getElementById("time").innerHTML = new Date().toLocaleTimeString();
            calculateMarks();
            window.print();
        }
        resetForm();
    </script>
</body>

</html>